!async function(){var o=Math.floor(2*Math.random())+1;$(".task-num, [data-target]").text(o);var w=o*$("[data-item]").length;let y=0,e=30,t=null,I=!1;function v(){clearInterval(t),I=!1,t=null}const x=new PIXI.Application;await x.init({backgroundAlpha:0,resizeTo:document.querySelector("#canvas-container"),resolution:window.devicePixelRatio||1,autoDensity:!0,antialias:!0}),document.querySelector("#canvas-container").appendChild(x.view);var r=async e=>{let{x:t,y:a,width:i,height:n,imgName:o,hitArea:s}=e;var h=o.split("-")[0];const d=new PIXI.Container;d.x=t+.5*i,d.y=a+.5*n,x.stage.addChild(d);var r,c,e=await PIXI.Assets.load(`https://kunbu0203.github.io/19940922/assets/image/map1/game/items/${o}.png`);const l=new PIXI.Sprite(e);l.anchor.set(.5),l.eventMode="static",l.cursor="pointer",void 0!==s&&0<s.length&&(r=-.5*i,c=-.5*n,g=s.map((e,t)=>t%2==0?e+r:e+c),l.hitArea=new PIXI.Polygon(g)),l.on("pointerdown",()=>{I&&(l.eventMode="none","coffee"!==h?(score[h]++,y++,$(`[data-item="${h}"]`).find("[data-num]").text(score[h]),m.play()):$(".game-stage").addClass("-coffee"),w===y&&setTimeout(()=>{v()},1e3),u.play())});var g=await PIXI.Assets.load(`https://kunbu0203.github.io/19940922/assets/image/map1/game/original/${o}.png`);const p=new PIXI.Sprite(g);p.anchor.set(.5),p.alpha=0,d.addChild(l),d.addChild(p);const m=gsap.timeline();if(m.pause(),"coffee"!==h){g=await PIXI.Assets.load("https://kunbu0203.github.io/19940922/assets/image/other/add.png");const f=new PIXI.Sprite(g);f.x=t+.5*i-55,f.y=a-86,f.alpha=0,m.to(f,{alpha:1,duration:.3}).to(f,{alpha:0,duration:.3,delay:.3}),x.stage.addChild(f)}const u=gsap.timeline();u.pause(),u.to(d.scale,{x:1.3,y:1.3,duration:.5,ease:"back.out(4)"}).to(p,{alpha:1,duration:.5},"<").to(d,{alpha:0,duration:.3,delay:.2})},c=async e=>{var{x:t,y:a,width:i,height:n,imgName:e}=e,e=await PIXI.Assets.load(`https://kunbu0203.github.io/19940922/assets/image/map1/game/leaf/${e}.png`);const o=new PIXI.Sprite(e);o.anchor.set(1,1),o.x=t+i,o.y=a+n,o.eventMode="static",o.on("pointerdown",()=>{o.eventMode="none",s.play()}),x.stage.addChild(o);const s=gsap.timeline();s.pause(),s.to(o,{y:a+n-100,rotation:Math.PI/180*40,alpha:0,duration:.6})};function a(){var e=document.querySelector("#canvas-container").offsetWidth;x.stage.scale.set(e/1170)}fetch("https://kunbu0203.github.io/19940922/assets/image/map1/game/data.json").then(e=>e.json()).then(e=>{Object.entries(e.items).forEach(e=>{var[h,t]=e;const d=[1,2,3,4].sort(()=>Math.random()-.5).slice(0,o).map(e=>e-1);d.map(e=>t[e]).forEach((e,t)=>{const{x:a,y:i,width:n,height:o,hitArea:s}=e;t=`${h}-${d[t]+1}`;if(r({x:a,y:i,width:n,height:o,imgName:t,hitArea:s}),e.leaf){const{x:a,y:i,width:n,height:o}=e.leaf;c({x:a,y:i,width:n,height:o,imgName:t})}})});const{x:t,y:a,width:i,height:n}=e.coffee;if(r({x:t,y:a,width:i,height:n,imgName:"coffee"}),e.coffee.leaf){const{x:t,y:a,width:i,height:n}=e.coffee.leaf;c({x:t,y:a,width:i,height:n,imgName:"coffee"})}}),window.addEventListener("resize",()=>{a()}),a(),null===t&&(I=!0,t=setInterval(()=>{e--,$("[data-second]").text(e),e<=0&&v()},1e3))}();
//# sourceMappingURL=pixi-game-novar.min.js.map
