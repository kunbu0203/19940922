$(function(){const h=document.querySelector("[data-camera-video]"),g=document.querySelector("[data-camera-canvas]"),l=g.getContext("2d");let t,e=!0;const u=new Image;function a(){navigator.mediaDevices.getUserMedia({video:!0}).then(function(e){t=e,h.srcObject=e}).catch(function(e){alert("取得相機訪問權限失敗: ",e.message,e.name)})}u.src="./assets/image/touch/logo.png",a(),h.addEventListener("loadeddata",function(){g.width=h.videoWidth,g.height=h.videoHeight},!1),$("[data-camera-direction]").on("click",function(){t.getTracks().forEach(e=>e.stop()),e=!e,a()});const i=new FaceMesh({locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${e}`});i.setOptions({maxNumFaces:1,refineLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),i.onResults(function(m){requestAnimationFrame(()=>{if(l.clearRect(0,0,g.width,g.height),l.save(),e&&(l.translate(g.width,0),l.scale(-1,1)),l.drawImage(m.image,0,0,g.width,g.height),m.multiFaceLandmarks&&0<m.multiFaceLandmarks.length){var n=m.multiFaceLandmarks[0];let e=1/0,t=1/0,a=-1/0,i=-1/0;for(const s of n){var c=s.x*g.width,d=s.y*g.height;e=Math.min(e,c),t=Math.min(t,d),a=Math.max(a,c),i=Math.max(i,d)}var o=(a-e)*(i-t),r=Math.max(.2,o/1e5),o=n[10],n=o.x*g.width,o=o.y*g.height;l.drawImage(u,n-.7*h.videoWidth*r/2,o-.7*h.videoWidth*r-20,.7*h.videoWidth*r,.7*h.videoWidth*r)}l.restore()})});const n=new Camera(h,{onFrame:async()=>{await i.send({image:h})},width:{ideal:1968},facingMode:e?"user":"environment"});n.start()});
//# sourceMappingURL=main2.min.js.map
