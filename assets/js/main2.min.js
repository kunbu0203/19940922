$(function(){const t=document.querySelector("[data-camera-video]"),h=document.querySelector("[data-camera-canvas]"),g=h.getContext("2d");let a,e=!0;const l=new Image;function n(){navigator.mediaDevices.getUserMedia({video:{facingMode:e?"user":"environment",width:{ideal:1170}}}).then(function(e){a=e,t.srcObject=e}).catch(function(e){alert("取得相機訪問權限失敗: ",e.message,e.name)})}l.src="./assets/image/touch/logo.png",n(),t.addEventListener("loadeddata",function(){alert(`${t.videoWidth}, ${t.videoHeight}`),h.width=t.videoWidth,h.height=t.videoHeight},!1),$("[data-camera-direction]").on("click",function(){a.getTracks().forEach(e=>e.stop()),e=!e,n()});const i=new FaceMesh({locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${e}`});i.setOptions({maxNumFaces:1,refineLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),i.onResults(function(m){requestAnimationFrame(()=>{if(g.clearRect(0,0,h.width,h.height),g.save(),e&&(g.translate(h.width,0),g.scale(-1,1)),g.drawImage(m.image,0,0,h.width,h.height),m.multiFaceLandmarks&&0<m.multiFaceLandmarks.length){var i=m.multiFaceLandmarks[0];let e=1/0,t=1/0,a=-1/0,n=-1/0;for(const s of i){var d=s.x*h.width,o=s.y*h.height;e=Math.min(e,d),t=Math.min(t,o),a=Math.max(a,d),n=Math.max(n,o)}var c=(a-e)*(n-t),r=Math.max(.2,c/1e5),c=i[10],i=c.x*h.width,c=c.y*h.height;g.drawImage(l,i-.3*window.innerWidth*r/2,c-.3*window.innerWidth*r-20,.3*window.innerWidth*r,.3*window.innerWidth*r)}g.restore()})});const d=new Camera(t,{onFrame:async()=>{await i.send({image:t})},facingMode:e?"user":"environment"});d.start()});
//# sourceMappingURL=main2.min.js.map
