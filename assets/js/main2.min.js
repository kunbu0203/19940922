$(function(){const a=document.querySelector("[data-camera-video]"),i=document.querySelector("[data-camera-canvas]"),c=i.getContext("2d");let t,o=!0;function e(){navigator.mediaDevices.getUserMedia({video:!0}).then(function(e){t=e,a.srcObject=e}).catch(function(e){alert("取得相機訪問權限失敗: ",e.message,e.name)})}e(),a.addEventListener("loadeddata",function(){i.width=a.videoWidth,i.height=a.videoHeight},!1),$("[data-camera-direction]").on("click",function(){t.getTracks().forEach(e=>e.stop()),o=!o,e()});const n=new FaceMesh({locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${e}`});n.setOptions({maxNumFaces:1,refineLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),n.onResults(function(n){requestAnimationFrame(()=>{if(c.clearRect(0,0,i.width,i.height),c.save(),o&&(c.translate(i.width,0),c.scale(-1,1)),c.drawImage(n.image,0,0,i.width,i.height),n.multiFaceLandmarks)for(const t of n.multiFaceLandmarks)drawConnectors(c,t,FACEMESH_RIGHT_EYE,{color:"#FF3030"}),drawConnectors(c,t,FACEMESH_LEFT_EYE,{color:"#30FF30"}),drawConnectors(c,t,FACEMESH_FACE_OVAL,{color:"#E0E0E0"}),drawConnectors(c,t,FACEMESH_LIPS,{color:"#E0E0E0"});var e,a;n.multiFaceLandmarks&&0<n.multiFaceLandmarks.length&&(e=(a=n.multiFaceLandmarks[0])[0],a=a[10],Math.abs(e.z-a.z),e=a.x*i.width,a=a.y*i.height,c.drawImage(r,e-.3*r.width/2,a-.3*r.height,.3*r.width,.3*r.height)),c.restore()})});const r=new Image;r.src="/assets/image/touch/logo.png";const d=new Camera(a,{onFrame:async()=>{await n.send({image:a})},width:{ideal:1968},height:{ideal:1968},facingMode:o?"user":"environment"});d.start()});
//# sourceMappingURL=main2.min.js.map
