$(function(){const a=document.querySelector("[data-camera-video]"),c=document.querySelector("[data-camera-canvas]"),o=c.getContext("2d");let t,r=!0;function e(){navigator.mediaDevices.getUserMedia({video:!0}).then(function(e){t=e,a.srcObject=e}).catch(function(e){alert("取得相機訪問權限失敗: ",e.message,e.name)})}e(),a.addEventListener("loadeddata",function(){c.width=a.videoWidth,c.height=a.videoHeight},!1),$("[data-camera-direction]").on("click",function(){t.getTracks().forEach(e=>e.stop()),r=!r,e()});const n=new FaceMesh({locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${e}`});n.setOptions({maxNumFaces:1,refineLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),n.onResults(function(i){requestAnimationFrame(()=>{if(o.clearRect(0,0,c.width,c.height),o.save(),r&&(o.translate(c.width,0),o.scale(-1,1)),o.drawImage(i.image,0,0,c.width,c.height),i.multiFaceLandmarks)for(const n of i.multiFaceLandmarks)drawConnectors(o,n,FACEMESH_RIGHT_EYE,{color:"#FF3030"}),drawConnectors(o,n,FACEMESH_LEFT_EYE,{color:"#30FF30"}),drawConnectors(o,n,FACEMESH_FACE_OVAL,{color:"#E0E0E0"}),drawConnectors(o,n,FACEMESH_LIPS,{color:"#E0E0E0"});var e,a,t;i.multiFaceLandmarks&&0<i.multiFaceLandmarks.length&&(t=(a=i.multiFaceLandmarks[0])[10],e=.01*(Math.abs(a[33].x-a[263].x)*c.width),a=t.x*c.width,t=t.y*c.height,o.drawImage(d,a-50*e,t-100*e,100*e,100*e)),o.restore()})});const d=new Image;d.src="/assets/image/touch/logo.png";const i=new Camera(a,{onFrame:async()=>{await n.send({image:a})},width:{ideal:1968},height:{ideal:1968},facingMode:r?"user":"environment"});i.start()});
//# sourceMappingURL=main2.min.js.map
