$(function(){const n=document.querySelector("[data-camera-video]"),m=document.querySelector("[data-camera-canvas]"),w=m.getContext("2d");let t,e=!0;const g=new Image;function i(){navigator.mediaDevices.getUserMedia({video:{facingMode:e?"user":"environment",width:{ideal:3*window.innerWidth}}}).then(function(e){t=e,n.srcObject=e}).catch(function(e){alert("取得相機訪問權限失敗: ",e.message,e.name)})}g.src="./assets/image/touch/logo.png",i(),n.addEventListener("loadeddata",function(){m.width=n.videoWidth,m.height=n.videoHeight},!1),$("[data-camera-direction]").on("click",function(){t.getTracks().forEach(e=>e.stop()),e=!e,i()});const a=new FaceMesh({locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${e}`});a.setOptions({maxNumFaces:1,refineLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),a.onResults(function(s){requestAnimationFrame(()=>{if(w.clearRect(0,0,m.width,m.height),w.save(),e&&(w.translate(m.width,0),w.scale(-1,1)),w.drawImage(s.image,0,0,m.width,m.height),s.multiFaceLandmarks&&0<s.multiFaceLandmarks.length){var a=s.multiFaceLandmarks[0];let e=1/0,n=1/0,t=-1/0,i=-1/0;for(const h of a){var d=h.x*m.width,o=h.y*m.height;e=Math.min(e,d),n=Math.min(n,o),t=Math.max(t,d),i=Math.max(i,o)}var c=(t-e)*(i-n),r=Math.max(.2,c/1e5),c=a[10],a=c.x*m.width,c=c.y*m.height;w.drawImage(g,a-.3*window.innerWidth*r/2,c-.3*window.innerWidth*r-20,.3*window.innerWidth*r,.3*window.innerWidth*r)}w.restore()})});const d=new Camera(n,{onFrame:async()=>{await a.send({image:n})},width:window.innerWidth,height:.8*window.innerHeight,facingMode:e?"user":"environment"});d.start()});
//# sourceMappingURL=main2.min.js.map
