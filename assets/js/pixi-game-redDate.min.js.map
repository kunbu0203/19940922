{"version":3,"sources":["assets/js/pixi-game-redDate.js"],"names":["targetNum","Math","floor","random","$","text","targetScore","length","currentScore","second","timer","isStart","endTimer","clearInterval","app","PIXI","Application","stageResize","canvasW","document","querySelector","offsetWidth","stage","scale","set","init","backgroundAlpha","resizeTo","resolution","window","devicePixelRatio","autoDensity","antialias","appendChild","view","_ref","x","y","width","height","imgName","name","split","container","Container","addChild","itemTexture","Assets","load","mapNum","item","Sprite","anchor","eventMode","cursor","on","score","find","addTl","play","addClass","setTimeout","itemTl","originalTexture","original","alpha","gsap","timeline","pause","addTexture","add","to","duration","delay","ease","createItem","addEventListener","setInterval"],"mappings":"CAAA,iBAEI,IAAMA,EAAYC,KAAKC,MAAsB,EAAhBD,KAAKE,UAAgB,EAElDC,EAAE,4BAA4BC,KAAKL,GACnC,IAAMM,EAAcN,EAAYI,EAAE,eAAeG,OACjD,IAAIC,EAAe,EAGfC,EAAS,GACTC,EAAQ,KACRC,GAAU,EAed,SAASC,IACLC,cAAcH,GACdC,GAAU,EACVD,EAAQ,KAKZ,MAAMI,EAAM,IAAIC,KAAKC,YAwGrB,SAASC,IACL,IAAMC,EAAUC,SAASC,cAAc,qBAAqBC,YAC5DP,EAAIQ,MAAMC,MAAMC,IAAIN,EAAU,YAzG5BJ,EAAIW,KAAK,CAGXC,gBAAiB,EACjBC,SAAUR,SAASC,cAAc,qBACjCQ,WAAYC,OAAOC,kBAAoB,EACvCC,aAAa,EACbC,WAAW,IAEfb,SAASC,cAAc,qBAAqBa,YAAYnB,EAAIoB,OAGzCC,MAAAA,IAAqD,GAA9C,CAAEC,EAAAA,EAAGC,EAAAA,EAAGC,MAAAA,EAAOC,OAAAA,EAAQC,QAAAA,GAAkBL,EAC/D,IAAMM,EAAOD,EAAQE,MAAM,KAAK,GAEhC,MAAMC,EAAY,IAAI5B,KAAK6B,UAC3BD,EAAUP,EAAIA,EAAY,GAARE,EAClBK,EAAUN,EAAIA,EAAa,GAATE,EAClBzB,EAAIQ,MAAMuB,SAASF,GAEbG,QAAoB/B,KAAKgC,OAAOC,6DAA6DC,qBAAqBT,SACxH,MAAMU,EAAO,IAAInC,KAAKoC,OAAOL,GAC7BI,EAAKE,OAAO5B,IAAI,IAChB0B,EAAKG,UAAY,SACjBH,EAAKI,OAAS,UACdJ,EAAKK,GAAG,cAAe,KACd5C,IACLuC,EAAKG,UAAY,OAEJ,WAATZ,GACAe,MAAMf,KACNjC,IAEAJ,iBAAiBqC,OAAUgB,KAAK,cAAcpD,KAAKmD,MAAMf,IACzDiB,EAAMC,QAENvD,EAAE,eAAewD,SAAS,WAG1BtD,IAAgBE,GAChBqD,WAAW,KACPjD,KACD,KAEPkD,EAAOH,UAGLI,QAAwBhD,KAAKgC,OAAOC,6DAA6DC,wBAAwBT,SAC/H,MAAMwB,EAAW,IAAIjD,KAAKoC,OAAOY,GACjCC,EAASZ,OAAO5B,IAAI,IACpBwC,EAASC,MAAQ,EAEjBtB,EAAUE,SAASK,GACnBP,EAAUE,SAASmB,GAEnB,MAAMN,EAAQQ,KAAKC,WAEnB,GADAT,EAAMU,QACO,WAAT3B,EAAmB,CACb4B,QAAmBtD,KAAKgC,OAAOC,KAAM,mEAC3C,MAAMsB,EAAM,IAAIvD,KAAKoC,OAAOkB,GAC5BC,EAAIlC,EAAIA,EAAa,GAARE,EAAe,GAC5BgC,EAAIjC,EAAIA,EAAI,GACZiC,EAAIL,MAAQ,EACZP,EACKa,GAAGD,EAAK,CACLL,MAAO,EACPO,SAAU,KAEbD,GAAGD,EAAK,CACLL,MAAO,EACPO,SAAU,GACVC,MAAO,KAEf3D,EAAIQ,MAAMuB,SAASyB,GAIvB,MAAMR,EAASI,KAAKC,WACpBL,EAAOM,QACPN,EACKS,GAAG5B,EAAUpB,MAAO,CACjBa,EAAG,IACHC,EAAG,IACHmC,SAAU,GACVE,KAAM,gBAETH,GAAGP,EAAU,CACVC,MAAO,EACPO,SAAU,IACX,KACFD,GAAG5B,EAAW,CACXsB,MAAO,EACPO,SAAU,GACVC,MAAO,MAGnBE,CAAW,CAAEvC,EAAG,IAAKC,EAAG,IAAKC,MAAO,IAAKC,OAAQ,GAAIC,QAAS,cAG9DX,OAAO+C,iBAAiB,SAAU,KAC9B3D,MAEJA,IA1HkB,OAAVP,IAEJC,GAAU,EACVD,EAAQmE,YAAY,KAChBpE,IACAL,EAAE,iBAAiBC,KAAKI,GAEpBA,GAAU,GAAGG,KAClB,MAvBX","file":"pixi-game-redDate.min.js","sourcesContent":["(async function () {\n    // 取得隨機目標數量(1-2個)\n    const targetNum = Math.floor(Math.random() * 2) + 1;\n    // const targetNum = 4;\n    $('.task-num, [data-target]').text(targetNum);\n    const targetScore = targetNum * $('[data-item]').length;\n    let currentScore = 0;\n\n    // 計時器\n    let second = 30;\n    let timer = null;\n    let isStart = false;\n\n    // 計時開始\n    function startTimer() {\n        if (timer !== null) return; // 避免重複開始\n\n        isStart = true;\n        timer = setInterval(() => {\n            second--;\n            $('[data-second]').text(second);\n\n            if (second <= 0) endTimer();\n        }, 1000);\n    }\n\n    function endTimer() {\n        clearInterval(timer);\n        isStart = false;\n        timer = null;\n        // gameEnd();\n    }\n\n    // 創建遊戲舞台\n    const app = new PIXI.Application();\n    await app.init({\n        // width: 1170,\n        // height: 1624,\n        backgroundAlpha: 0,\n        resizeTo: document.querySelector('#canvas-container'),\n        resolution: window.devicePixelRatio || 1,\n        autoDensity: true,\n        antialias: true\n    });\n    document.querySelector('#canvas-container').appendChild(app.view);\n\n    // 新增物件\n    const createItem = async ({ x, y, width, height, imgName, hitArea }) => {\n        const name = imgName.split('-')[0];\n\n        const container = new PIXI.Container();\n        container.x = x + width * 0.5;\n        container.y = y + height * 0.5;\n        app.stage.addChild(container);\n\n        const itemTexture = await PIXI.Assets.load(`https://kunbu0203.github.io/19940922/assets/image/map${mapNum}/game/items/${imgName}.png`);\n        const item = new PIXI.Sprite(itemTexture);\n        item.anchor.set(0.5);\n        item.eventMode = 'static';\n        item.cursor = 'pointer';\n        item.on('pointerdown', () => {\n            if (!isStart) return;\n            item.eventMode = 'none';\n\n            if (name !== 'coffee') {\n                score[name]++;\n                currentScore++;\n                // $(`[data-item=\"${name}\"]`).addClass('-active').find('[data-num]').text(score[name]);\n                $(`[data-item=\"${name}\"]`).find('[data-num]').text(score[name]);\n                addTl.play();\n            } else {\n                $('.game-stage').addClass('-coffee');\n            }\n\n            if (targetScore === currentScore) {\n                setTimeout(() => {\n                    endTimer();\n                }, 1000);\n            }\n            itemTl.play();\n        });\n\n        const originalTexture = await PIXI.Assets.load(`https://kunbu0203.github.io/19940922/assets/image/map${mapNum}/game/original/${imgName}.png`);\n        const original = new PIXI.Sprite(originalTexture);\n        original.anchor.set(0.5);\n        original.alpha = 0;\n\n        container.addChild(item);\n        container.addChild(original);\n\n        const addTl = gsap.timeline();\n        addTl.pause();\n        if (name !== 'coffee') {\n            const addTexture = await PIXI.Assets.load(`https://kunbu0203.github.io/19940922/assets/image/other/add.png`);\n            const add = new PIXI.Sprite(addTexture);\n            add.x = x + (width * 0.5) - 55;\n            add.y = y - 86;\n            add.alpha = 0;\n            addTl\n                .to(add, {\n                    alpha: 1,\n                    duration: 0.3\n                })\n                .to(add, {\n                    alpha: 0,\n                    duration: 0.3,\n                    delay: 0.3\n                });\n            app.stage.addChild(add);\n        }\n\n        // 物件點擊動畫\n        const itemTl = gsap.timeline();\n        itemTl.pause();\n        itemTl\n            .to(container.scale, {\n                x: 1.3,\n                y: 1.3,\n                duration: 0.5,\n                ease: 'back.out(4)'\n            })\n            .to(original, {\n                alpha: 1,\n                duration: 0.5\n            }, '<')\n            .to(container, {\n                alpha: 0,\n                duration: 0.3,\n                delay: 0.2\n            });\n    }\n    createItem({ x: 158, y: 540, width: 113, height: 91, imgName: 'redDate-1' });\n\n\n    window.addEventListener('resize', () => {\n        stageResize();\n    });\n    stageResize();\n    function stageResize() {\n        const canvasW = document.querySelector('#canvas-container').offsetWidth;\n        app.stage.scale.set(canvasW / 1170);\n    }\n\n    startTimer();\n})();\n"],"sourceRoot":"/"}