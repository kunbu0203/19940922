!async function(){var i=Math.floor(2*Math.random())+1;$(".task-num, [data-target]").text(i);var p=i*$("[data-item]").length;let f=0,t=30,e=null,u=!1;function I(){clearInterval(e),u=!1,e=null}const v=new PIXI.Application;await v.init({backgroundAlpha:0,resizeTo:document.querySelector("#canvas-container"),resolution:window.devicePixelRatio||1,autoDensity:!0,antialias:!0}),document.querySelector("#canvas-container").appendChild(v.view);var g=async t=>{let{x:e,y:i,width:a,height:h,imgName:n,hitArea:o}=t;var d=n.split("-")[0];const s=new PIXI.Container;s.x=e+.5*a,s.y=i+.5*h,v.stage.addChild(s);var g,l,t=await PIXI.Assets.load(`https://kunbu0203.github.io/19940922/assets/image/map${mapNum}/game/items/${n}.png`);const r=new PIXI.Sprite(t);r.anchor.set(.5),r.eventMode="static",r.cursor="pointer",void 0!==o&&0<o.length&&(g=-.5*a,l=-.5*h,c=o.map((t,e)=>e%2==0?t+g:t+l),r.hitArea=new PIXI.Polygon(c)),r.on("pointerdown",()=>{u&&(r.eventMode="none","coffee"!==d?(score[d]++,f++,$(`[data-item="${d}"]`).find("[data-num]").text(score[d]),y.play()):$(".game-stage").addClass("-coffee"),p===f&&setTimeout(()=>{I()},1e3),m.play())});var c=await PIXI.Assets.load(`https://kunbu0203.github.io/19940922/assets/image/map${mapNum}/game/original/${n}.png`);const w=new PIXI.Sprite(c);w.anchor.set(.5),w.alpha=0,s.addChild(r),s.addChild(w);const y=gsap.timeline();if(y.pause(),"coffee"!==d){c=await PIXI.Assets.load("https://kunbu0203.github.io/19940922/assets/image/other/add.png");const x=new PIXI.Sprite(c);x.x=e+.5*a-55,x.y=i-86,x.alpha=0,y.to(x,{alpha:1,duration:.3}).to(x,{alpha:0,duration:.3,delay:.3}),v.stage.addChild(x)}const m=gsap.timeline();m.pause(),m.to(s.scale,{x:1.3,y:1.3,duration:.5,ease:"back.out(4)"}).to(w,{alpha:1,duration:.5},"<").to(s,{alpha:0,duration:.3,delay:.2})},l=async t=>{var{x:e,y:i,width:a,height:h,imgName:t}=t,t=await PIXI.Assets.load(`https://kunbu0203.github.io/19940922/assets/image/map${mapNum}/game/leaf/${t}.png`);const n=new PIXI.Sprite(t);n.anchor.set(1,1),n.x=e+a,n.y=i+h,n.eventMode="static",n.on("pointerdown",()=>{n.eventMode="none",o.play()}),v.stage.addChild(n);const o=gsap.timeline();o.pause(),o.to(n,{y:i+h-100,rotation:Math.PI/180*40,alpha:0,duration:.6})},a={items:{redBean:[{x:221,y:1427,width:175,height:86,leaf:{x:268,y:1369,width:239,height:157}},{x:728,y:1233,width:72,height:39,leaf:{x:735,y:1175,width:97,height:123}},{x:921,y:1419,width:100,height:48},{x:0,y:1260,width:110,height:54}],mulberryLeaf:[{x:924,y:282,width:136,height:150},{x:640,y:873,width:130,height:95},{x:72,y:794,width:108,height:79},{x:171,y:143,width:146,height:118}],jobsTears:[{x:1006,y:1359,width:73,height:46,leaf:{x:987,y:1279,width:119,height:78}},{x:618,y:1176,width:61,height:32},{x:338,y:1204,width:92,height:49,leaf:{x:333,y:1184,width:119,height:76}},{x:680,y:1349,width:146,height:78}],redDate:[{x:158,y:540,width:113,height:97},{x:980,y:998,width:113,height:97,leaf:{x:939,y:969,width:231,height:211}},{x:470,y:758,width:70,height:72,leaf:{x:466,y:730,width:106,height:118}},{x:704,y:549,width:99,height:86,leaf:{x:674,y:533,width:152,height:133}}],blackBean:[{x:580,y:1507,width:149,height:73},{x:848,y:1290,width:105,height:52,leaf:{x:835,y:1265,width:136,height:90}},{x:70,y:1478,width:82,height:40,leaf:{x:7,y:1394,width:143,height:182}},{x:252,y:1316,width:88,height:50}]},coffee:{x:430,y:1280,width:180,height:91}};Object.entries(a.items).forEach(t=>{var[d,e]=t;const s=[1,2,3,4].sort(()=>Math.random()-.5).slice(0,i).map(t=>t-1);s.map(t=>e[t]).forEach((t,e)=>{const{x:i,y:a,width:h,height:n,hitArea:o}=t;e=`${d}-${s[e]+1}`;if(g({x:i,y:a,width:h,height:n,imgName:e,hitArea:o}),t.leaf){const{x:i,y:a,width:h,height:n}=t.leaf;l({x:i,y:a,width:h,height:n,imgName:e})}})});const{x:h,y:n,width:o,height:d}=a.coffee;if(g({x:h,y:n,width:o,height:d,imgName:"coffee"}),a.coffee.leaf){const{x:h,y:n,width:o,height:d}=a.coffee.leaf;l({x:h,y:n,width:o,height:d,imgName:"coffee"})}function s(){var t=document.querySelector("#canvas-container").offsetWidth;v.stage.scale.set(t/1170)}window.addEventListener("resize",()=>{s()}),s(),null===e&&(u=!0,e=setInterval(()=>{t--,$("[data-second]").text(t),t<=0&&I()},1e3))}();
//# sourceMappingURL=pixi-game-nojson.min.js.map
