$(function(){const t=document.querySelector("[data-camera-video]"),c=document.querySelector("[data-camera-canvas]"),o=c.getContext("2d");let a,e=!0;function n(){navigator.mediaDevices.getUserMedia({video:{facingMode:e?"user":"environment",width:{ideal:1968}}}).then(function(e){a=e,t.srcObject=e}).catch(function(e){alert("取得相機訪問權限失敗: ",e.message,e.name)})}n(),t.addEventListener("play",function(){c.width=t.videoWidth,c.height=t.videoHeight},!1),$("[data-camera-direction]").on("click",function(){a.getTracks().forEach(e=>e.stop()),e=!e,n()});const i=new FaceMesh({locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${e}`});i.setOptions({maxNumFaces:1,refineLandmarks:!0,minDetectionConfidence:.5,minTrackingConfidence:.5}),i.onResults(function(i){requestAnimationFrame(()=>{if(o.clearRect(0,0,c.width,c.height),o.drawImage(i.image,0,0,c.width,c.height),i.multiFaceLandmarks)for(const n of i.multiFaceLandmarks)drawConnectors(o,n,FACEMESH_RIGHT_EYE,{color:"#FF3030"}),drawConnectors(o,n,FACEMESH_LEFT_EYE,{color:"#30FF30"}),drawConnectors(o,n,FACEMESH_FACE_OVAL,{color:"#E0E0E0"}),drawConnectors(o,n,FACEMESH_LIPS,{color:"#E0E0E0"});var e,t,a;i.multiFaceLandmarks&&0<i.multiFaceLandmarks.length&&(e=(t=i.multiFaceLandmarks[0])[0],a=t[10],t=Math.abs(e.z-a.z),e=.1*Math.max(.5,2-t),t=a.x*c.width,a=a.y*c.height,o.drawImage(r,t-r.width*e/2,a-r.height*e,r.width*e,r.height*e))})});const r=new Image;r.src="/assets/image/touch/logo.png";const d=new Camera(t,{onFrame:async()=>{await i.send({image:t})},width:{ideal:1968},height:4*c.height,facingMode:e?"user":"environment"});d.start()});
//# sourceMappingURL=main.min.js.map
